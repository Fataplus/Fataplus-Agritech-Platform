# Fataplus Mobile App with Offline LLM Support

## Overview
This implementation adds offline LLM (Large Language Model) capabilities to the Fataplus mobile app, specifically designed for farmers in Madagascar and other regions with limited internet connectivity. The solution enables peer-to-peer sharing of AI assistance through local hosting and QR code-based connections.

## Features

### Offline LLM Inference
- On-device LLM execution using React Native RAG library
- No internet required for AI assistance
- Optimized for low-resource devices

### Peer-to-Peer Sharing
- Local LLM hosting via hotspot connectivity
- QR code-based connection sharing
- Technician-to-farmer knowledge transfer

### Chat Traceability
- Local conversation logging
- Session management for multiple conversations
- Data persistence using AsyncStorage

## Technical Implementation

### Dependencies
- `react-native-rag`: Core RAG functionality
- `@react-native-rag/executorch`: On-device LLM inference
- `react-native-qrcode-svg`: QR code generation
- `react-native-wifi-p2p`: Peer-to-peer networking
- `@react-native-async-storage/async-storage`: Data persistence

### Architecture
```
src/
├── services/
│   ├── ragService.ts        # RAG system management
│   ├── qrService.ts         # QR code handling
│   ├── networkService.ts    # Networking and hotspot management
│   └── chatService.ts       # Chat session management
├── components/
│   └── LocalLLMView.tsx     # Main UI component
└── App.tsx                  # Main application entry
```

### Key Components

#### RAG Service
Manages the Retrieval-Augmented Generation system:
- Initializes local LLM and embeddings
- Handles document storage in vector database
- Generates responses from user queries

#### QR Service
Handles QR code generation and parsing:
- Creates connection QR codes for LLM sharing
- Parses scanned QR codes to extract connection info
- Validates connection freshness

#### Network Service
Manages peer-to-peer connectivity:
- Initializes WiFi P2P functionality
- Starts/stops hotspot hosting
- Discovers and connects to nearby devices

#### Chat Service
Manages conversation history:
- Creates and manages chat sessions
- Stores messages locally
- Retrieves conversation history

## Usage

### For Farmers
1. Open the Fataplus mobile app
2. Tap "Try Offline AI" to access the local LLM interface
3. Ask questions about farming, weather, crops, etc.
4. View responses generated by the local AI assistant

### For Technicians
1. Open the Fataplus mobile app
2. Tap "Try Offline AI" to access the local LLM interface
3. Tap "Share My AI" to start hosting the local LLM
4. Show the generated QR code to farmers
5. Farmers can scan the QR code to connect to your hosted LLM

### For Connected Scenarios
1. When internet connectivity is available, chat logs can be synchronized
2. Conversations can be continued across devices
3. Knowledge can be shared with the broader agricultural community

## Development Setup

### Prerequisites
- Node.js 16+
- React Native development environment
- Android/iOS development tools

### Installation
```bash
cd mobile-app
npm install
```

### Running the App
```bash
# For iOS
npx react-native run-ios

# For Android
npx react-native run-android
```

## Future Enhancements

### Performance Optimization
- Model compression for lower-end devices
- Caching strategies for frequently asked questions
- Background processing for non-critical tasks

### Enhanced Features
- Voice input for low-literacy users
- Image recognition for crop/livestock diagnostics
- Multilingual support for local dialects
- Offline maps integration

### Network Improvements
- Bluetooth-based sharing as alternative to WiFi
- Mesh networking for rural areas
- Improved connection reliability

## Testing

### Offline Testing
- Simulate various network conditions
- Test on low-resource devices
- Validate QR code scanning accuracy

### Peer-to-Peer Testing
- Multiple device connection scenarios
- Hotspot stability under load
- Cross-platform compatibility

### Data Persistence
- Chat history recovery after app restart
- Storage limits and cleanup policies
- Backup and restore functionality

## Troubleshooting

### Common Issues
- **LLM Initialization Failures**: Check device compatibility and available storage
- **QR Code Scanning Issues**: Ensure proper lighting and camera permissions
- **Connection Problems**: Verify hotspot settings and device compatibility

### Support
For issues with the offline LLM functionality, contact the Fataplus development team.